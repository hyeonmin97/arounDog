# latteFactory
자전거에 여러가지 센서를 장착해 자전거를 편하고 안전하게 이용할 수 있는 시스템

<br>

# 기능
1. 전/후방 물체 인식시 탑승자에게 알림 기능
   - 초음파 센서와 라이다 센서를 전,후방에 부착해 물체가 일정거리 안에 들어오면 인식
   - 물체를 인식하면 진동 모터와 버저를 사용해 사용자에게 알림
3. 넘어짐 인식 기능
   - 자이로 센서와 가속도 센서를 사용해 자전거의 각도 확인
   - 넘어짐을 구분하기 위해 어플리케이션에서 넘어졌는지 여부를 확인, 넘어졌다고 판단 시 비상연락망에 현재 위치 전송
4. 실시간 후방 카메라
   - 웹캠을 이용해 실시간 후방의 모습을 안드로이드에서 확인 가능
6. 블랙박스
   - 후방의 모습을 녹화하여 저장하고, 안드로이드에서는 이를 다운받아 확인 가능

<br>

# 시스템 구성도
## 전체 구성도

<div align="center">
<img src = "https://github.com/hyeonmin97/latteFactory/assets/58110946/8854da74-e4e6-4d98-9d97-8d09b86cc300">
</div>

## 실제 장착 모습
<div align="center">
<img src = "https://github.com/hyeonmin97/latteFactory/assets/58110946/b9bf2db9-de7d-40c7-b9b4-a9510581f214">

<br>

<img src = "https://github.com/hyeonmin97/latteFactory/assets/58110946/23eccfa1-6194-42a3-9f70-fdfcc730263b">
</div>

<br>

# 통신 설계
<div align="center">
<img src = "https://github.com/hyeonmin97/latteFactory/assets/58110946/7cb34a73-c64c-49fe-b4f9-3945e916cefb">
</div>

<br>

# 문제 해결
- 기존의 안드로이드-라즈베리파이 소켓 연결 시 같은 네트워크 내에 있어야 한다는 문제 발생
  - 통신 방식을 블루투스로 변경하여 페어링이 되어있으면 연결될 수 있도록 구현
- 블랙박스 영상 길이 제어가 안되는 문제 발생
  - 후방 스트리밍 관련 코드와 블랙박스 저장 관련 코드 모두에서 카메라 이미지 프레임을 읽어들이는 것이 아닌 블랙박스에서 읽어들인 이미지를 사용하는것으로 변경
- 왼쪽, 오른쪽 라이다 센서를 동시에 읽을 수 없는 문제 발생
  - 스레드를 나누어 해결
